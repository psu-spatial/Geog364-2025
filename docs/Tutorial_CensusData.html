<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tutorial_CensusData.knit</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="in_GEOG364_FAQ.html">FAQs</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    YOUR LABS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_GEOG364_Lab1.html">Lab 1: Basics</a>
    </li>
    <li>
      <a href="in_GEOG364_Lab2.html">Lab 2: Data summary</a>
    </li>
    <li>
      <a href="in_GEOG364_Lab3.html">Lab 3: Spatial Basics</a>
    </li>
    <li>
      <a href="in_GEOG364_Lab4.html">Lab 4: Spatial Wrangling</a>
    </li>
    <li>
      <a href="in_GEOG364_Lab5.html">Lab 5: Moran's I</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="gettingplotting-us-census-data" class="section level1">
<h1>Getting/Plotting US-Census data</h1>
<p>R allows you to access and download all of the US Census and American
Community survey data with a few quick commands.</p>
<p>These are two wonderful tutorials for using these functions in more
depth.</p>
<ul>
<li><p><a
href="https://walker-data.com/tidycensus/articles/basic-usage.html"
class="uri">https://walker-data.com/tidycensus/articles/basic-usage.html</a></p></li>
<li><p><a href="https://crd150.github.io/lab3.html#Using_the_Census_API"
class="uri">https://crd150.github.io/lab3.html#Using_the_Census_API</a></p></li>
</ul>
<p>All the code is summarised at the end in a single code chunk.</p>
<p><br></p>
<div id="libraries-needed-for-this-tutorial." class="section level2">
<h2>Libraries needed for this tutorial.</h2>
<p>Make sure all of these libraries are at the top of your lab script in
a code chunk, and run the code chunk! If you run the code chunk and it
says a package is missing, either click “install” if the little yellow
bar appears at the top, or go to the Packages tab, and click Install to
go to the package ‘app store’.</p>
<pre class="r"><code>library(readxl)
library(tidyverse)
library(dplyr)
library(terra)
library(sf)
library(tmap)
library(ggplot2)
library(ggthemes)
library(viridis)
library(RColorBrewer)
library(plotly)
library(spatstat)
library(sfdep)
library(tidycensus)
library(units)</code></pre>
<p><br></p>
</div>
<div id="get-an-apipassword" class="section level2">
<h2>Get an API/password</h2>
<p><strong>THIS IS A ONE OFF PROCESS</strong>. If you run the command
several times or include it in your lab report, it will give an error
and will not allow you to knit. <strong>Make sure that you run the
command IN THE CONSOLE, not in a code chunk.</strong></p>
<p><br></p>
<div id="sign-up-online" class="section level3">
<h3>Sign up online</h3>
<p>First, you need to sign up in advance for a password, called an API
key. You can use Penn State as the organisation. In a few minutes,
e-mail you a personal access code called an API key. Click the link in
the e-mail to activate.</p>
<p><a href="https://api.census.gov/data/key_signup.html"
class="uri">https://api.census.gov/data/key_signup.html</a></p>
<p><em>Sometimes your key will just stop working. If that happens, it’s
fine to sign up for a new one.</em></p>
</div>
<div id="teach-r-your-api-key" class="section level3 unnumbered">
<h3 class="unnumbered">Teach R your API key</h3>
<p>You don’t need to type this password in every time you run R. Instead
we will teach it to R once.</p>
<ul>
<li><u><strong>IN THE CONSOLE!!</strong></u>, <br><br />
Type this command, but replace “YOUR API KEY GOES HERE” with the
password you were given. This will now save the password on your
system.</li>
</ul>
<p><br></p>
<pre class="r"><code># DO NOT RUN THIS IN A CODE CHUNK, COPY IT INTO THE CONSOLE &amp; RUN IT THERE
tidycensus::census_api_key(&quot;YOUR API KEY GOES HERE&quot;, install=TRUE,overwrite=TRUE)

# Here is an imaginary example, YOU NEED YOUR OWN NUMBER
# census_api_key(&quot;d2a990g429206c51b54n98ec51886c6cf01a7ef2&quot;, install=TRUE,overwrite=TRUE)</code></pre>
<p><br></p>
<p><strong>FINALLY, RESTART R STUDIO OR NOTHING WILL
WORK!!</strong><br />
On your laptop, shut R-studio down and restart by going to your lab5
project and double clicking on the .RProj file. On the cloud, go to the
Session menu at the top and click “restart R and clear output”.</p>
<p><br></p>
</div>
</div>
<div id="downloading-federal-data-using-get_acs" class="section level2">
<h2>Downloading federal data using Get_ACS</h2>
<p>TidyCensus allows you access to many large data-sets. For example</p>
<ul>
<li><code>get_acs()</code> Obtains data and feature geometry for the
American Community Survey</li>
<li><code>get_decennial()</code> Obtains data and feature geometry for
the decennial US Census</li>
<li><code>get_estimates()</code> Gets data from the US Census Bureau
Population Estimates APIs</li>
<li><code>get_flows()</code> Obtains data and feature geometry for
American Community Survey Migration Flows</li>
</ul>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Each command has similar arguments. Here is an example for get_acs()
where I download county level American Community Survey data for Maine
and New Hampshire.</p>
<p>First, set up your code chunk carefully because it really likes to
output spurious text. Add these code chunk options: {r,
results=‘hide’,message=FALSE,warning=FALSE}</p>
<p>Here is the command.</p>
<pre class="r"><code># Download some data for Maine and NH using get_acs
# THIS WILL NOT WORK IF YOU DIDN&#39;T RUN YOUR API KEY CODE &amp; RESTART R-STUDIO

ACS_county.sf &lt;- get_acs(geography = &quot;county&quot;, 
                         year = 2019,
                         variables = c(housevalue  = &quot;B25075_001&quot;,  # house value
                                       total_pop   = &quot;B05012_001&quot;,  # total population
                                       total_house = &quot;B25001_001&quot;,  # no. houses
                                       med.income  = &quot;B19013_001&quot;), # median income  
                         state = c(&quot;ME&quot;, &quot;NH&quot;),
                         survey = &quot;acs5&quot;, geometry = TRUE,
                         output = &quot;wide&quot;, show_call = FALSE)</code></pre>
<p>Here is what each argument means:</p>
<ul>
<li><strong><code>geography</code>:</strong> The level of geography we
want the data in; in our case, the county. Other geographic options
include “tract” for census tracts, plus tens more can be found here in
the table <a
href="https://walker-data.com/tidycensus/articles/basic-usage.html"
class="uri">https://walker-data.com/tidycensus/articles/basic-usage.html</a><br></li>
<li><strong><code>year</code>:</strong> The end year of the
data.<br></li>
<li><strong><code>variables</code>:</strong> The variables we want to
bring in as specified in a vector you create using the function c().
Note that we created variable names of our own (e.g. “topop”) and we put
the ACS IDs in quotes (“B03002_003”). Had we not done this, the variable
names will come in as they are named in the ACS, which are not very
descriptive.<br></li>
<li><strong><code>state</code>:</strong> We can filter the counties to
those in a specific state. Here it is c(“PA”, “NY”) for Pennsylvania and
New York. If we don’t specify this, we get all counties in the United
States - this is a HUGE download. <br></li>
<li><strong><code>survey</code>:</strong> The specific Census survey
were extracting data from. We want data from the 5-year American
Community Survey, so we specify “acs5”. The ACS comes in 1-, 3-, and
5-year varieties.<br></li>
<li><strong><code>geometry</code>:</strong> If geometry is set to FALSE,
it just brings in a standard non-spatial table. If it’s set to true, it
makes the data into a spatial sf file.<br></li>
<li><strong><code>wide</code>:</strong> This makes on column for each
variable, setting it to false would make one single column for all the
estimates and one for the margin of error. We normally want
wide=TRUE<br></li>
</ul>
</div>
<div id="how-to-find-variable-names" class="section level3">
<h3>How to find variable names</h3>
<p>There are <em>hundreds</em> of variables you can download. You can
see a full list here: <a
href="https://www.socialexplorer.com/data/ACS2017_5yr/metadata/?ds=ACS17_5yr"
class="uri">https://www.socialexplorer.com/data/ACS2017_5yr/metadata/?ds=ACS17_5yr</a></p>
<p>For example:</p>
<ul>
<li>“B05012_001”, total population</li>
<li>“B25001_001”, total housing units</li>
<li>“B25075_001”, house value</li>
<li>“B02001_004”, total who identify as native american</li>
<li>“B03003_003”, total who identify as Hispanic</li>
<li>“B03001_008”, total who identify as Hispanic Central A</li>
<li>“B03001_016”, total who identify as Hispanic South A</li>
<li>“B03002_003”, total who identify as white</li>
<li>“B03002_004”, total who identify as black</li>
<li>“B19013_001”, median income</li>
<li>“B06010_011”, number of people making &gt; 75000 USD</li>
<li>“B05012_003”, number of foreign born people</li>
<li>“B25035_001”, average house age</li>
<li>“B25105_001”, monthly house expenditures</li>
<li>“B25064_001”, median rent</li>
<li>“B08101_049”, number who work from home</li>
<li>“B25003_002”, total owner occupied</li>
<li>“B25041_001”, total number of beds in the house</li>
<li>“B28002_004”, total with broadband access</li>
<li>“B25047_003”, total without plumbing</li>
<li>“B25047_002”, all mobile homes -</li>
<li>“B25024_010”, native mobile homes</li>
<li>“B25032E_010”, total with complete plumbing</li>
<li>“B15012_001” , total with at least a bachelors degree</li>
</ul>
<p>If you add new variables, make sure they are inside the parentheses
for the variable argument! A common error is to add them as a new line,
not adding to the list of variables.</p>
<p><br></p>
</div>
</div>
<div id="wrangling-census-data" class="section level2">
<h2>Wrangling census data</h2>
<p>If you got it working and click on/view ACS_county.sf from the
Environment tab, you should now see that it has downloaded each one of
your variables for every county in Maine and NH</p>
<div id="estimates-vs-margin-of-error"
class="section level3 unnumbered">
<h3 class="unnumbered">Estimates vs Margin of Error</h3>
<p>In fact, for every one, it has downloaded the ESTIMATE of what they
think that variable is for that region, but also has included the
MARGIN-OF-ERROR, the 90% confidence interval on our result (90% of the
time our result should be within this margin of error)</p>
<p><strong>So any column-name with an E at the end is the estimate and
anything with an M at the end are the error bars on that
estimate.</strong></p>
<p>e.g.</p>
<pre class="r"><code>names(ACS_county.sf)</code></pre>
<pre><code>##  [1] &quot;GEOID&quot;        &quot;NAME&quot;         &quot;housevalueE&quot;  &quot;housevalueM&quot;  &quot;total_popE&quot;  
##  [6] &quot;total_popM&quot;   &quot;total_houseE&quot; &quot;total_houseM&quot; &quot;med.incomeE&quot;  &quot;med.incomeM&quot; 
## [11] &quot;geometry&quot;</code></pre>
<p><br></p>
<div id="removing-margin-of-error" class="section level4">
<h4>Removing margin of error</h4>
<p>To make your lives less confusing, we are going to remove the margin
of error columns</p>
<pre class="r"><code># This is optional, for more advanced work, you probably want to keep the error columns

ACS_county.sf &lt;- ACS_county.sf %&gt;%
  select(
    GEOID, 
    NAME,
    housevalue   = housevalueE, 
    total_pop    = total_popE, 
    total_house  = total_houseE, 
    med.income   = med.incomeE,
    geometry
    )</code></pre>
<p><br></p>
</div>
</div>
<div id="removing-margin-of-error-1" class="section level3 unnumbered">
<h3 class="unnumbered">Removing margin of error</h3>
<p>Once we have the data, we want to do things with it.</p>
<pre class="r"><code># Change the map projection to Albers equal projection, 
# then remove empty polygons (lakes etc) and fix any broken geometry
ACS_county.sf &lt;- ACS_county.sf %&gt;%
  st_transform(5070) %&gt;%
  filter(!st_is_empty(geometry)) %&gt;%
  st_make_valid()


# Find the areas in each county &amp; change the units from metres squared to km squared
ACS_county.sf$Area  &lt;- st_area(ACS_county.sf)
ACS_county.sf$Area  &lt;- as.numeric(set_units(ACS_county.sf$Area,&quot;km^2&quot;))


# Divide the total population &amp; housing by the area to give the population/housing density
ACS_county.sf$pop_density_km2  &lt;- ACS_county.sf$total_pop   / ACS_county.sf$Area
ACS_county.sf$house_density_km2 &lt;- ACS_county.sf$total_house / ACS_county.sf$Area

# And tidy up
ACS_county.sf &lt;- st_make_valid(ACS_county.sf)</code></pre>
<p><br></p>
</div>
</div>
<div id="plotting-census-data-using-tm_polygons" class="section level2">
<h2>Plotting census data using tm_polygons</h2>
<p>THIS IS AN EXAMPLE.</p>
<p>You can now plot the census data like any other spatial dataset. For
example, here is how to plot three things together. Again, I suggest
including message=FALSE and warning=FALSE in your code chunk
options.</p>
<p>For other color options, type &amp; run cols4all::c4a_palettes() INTO
THE CONSOLE.</p>
<pre class="r"><code># I make each map but save them rather than show them on the screen

# Total population
map_totalpop &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;total_pop&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.blues&quot;, 
                                     style = &quot;jenks&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;County population&quot;)) + 
                tm_basemap(&quot;CartoDB.Voyager&quot;) 

# Area 
map_area &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;Area&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.yl_gn_bu&quot;,
                                     style. = &quot;pretty&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;County area (km2)&quot;)) +
                tm_basemap(&quot;CartoDB.Voyager&quot;)


map_popdens &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;pop_density_km2&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.yl_or_rd&quot;,
                                     style. = &quot;jenks&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;Population Density (ppl/km2)&quot;)) +
                tm_basemap(&quot;CartoDB.Voyager&quot;)



# Now show them together
tmap_mode(&quot;plot&quot;)
tmap_arrange(map_totalpop,map_area,map_popdens)</code></pre>
<p><img src="Tutorial_CensusData_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>There are a load more ideas here for making pretty tmap plots: - <a
href="http://zevross.com/blog/2018/10/02/creating-beautiful-demographic-maps-in-r-with-the-tidycensus-and-tmap-packages/"
class="uri">http://zevross.com/blog/2018/10/02/creating-beautiful-demographic-maps-in-r-with-the-tidycensus-and-tmap-packages/</a></p>
</div>
<div id="code-summary" class="section level2">
<h2>Code summary</h2>
<pre class="r"><code>library(readxl)
library(tidyverse)
library(dplyr)
library(terra)
library(sf)
library(tmap)
library(ggplot2)
library(ggthemes)
library(viridis)
library(RColorBrewer)
library(plotly)
library(spatstat)
library(sfdep)
library(tidycensus)


# Download some data for Maine and NH using get_acs
# THIS WILL NOT WORK IF YOU DID&#39;T RUN YOUR API KEY CODE &amp; RESTART R-STUDIO
ACS_county.sf &lt;- get_acs(geography = &quot;county&quot;, 
                         year = 2019,
                         variables = c(housevalue  = &quot;B25075_001&quot;,  # house value
                                       total_pop   = &quot;B05012_001&quot;,  # total population
                                       total_house = &quot;B25001_001&quot;,  # no. houses
                                       med.income  = &quot;B19013_001&quot;), # median income  
                         state = c(&quot;ME&quot;, &quot;NH&quot;),
                         survey = &quot;acs5&quot;, geometry = TRUE,
                         output = &quot;wide&quot;, show_call = FALSE)


# OPTIONAL. For more advanced work, you probably want to keep the error columns
# If you don&#39;t run it, remember all your columns have an E on the end of the name 
ACS_county.sf &lt;- ACS_county.sf %&gt;%
  select(
    GEOID, 
    NAME,
    housevalue   = housevalueE, 
    total_pop    = total_popE, 
    total_house  = total_houseE, 
    med.income   = med.incomeE,
    geometry
    )


# Change the map projection to Albers equal projection, 
# then remove empty polygons (lakes etc) and fix any broken geometry
ACS_county.sf &lt;- ACS_county.sf %&gt;%
  st_transform(5070) %&gt;%
  filter(!st_is_empty(geometry)) %&gt;%
  st_make_valid()


# Find the areas in each county &amp; change the units from metres squared to km squared
ACS_county.sf$Area  &lt;- st_area(ACS_county.sf)
ACS_county.sf$Area  &lt;- as.numeric(set_units(ACS_county.sf$Area,&quot;km^2&quot;))



# OPTIONAL &amp; DEPENDS ON THE VARIABLES YOU DOWNLOAD
# Divide the total population &amp; housing by the area to give the population/housing density
ACS_county.sf$pop_density_km2  &lt;- ACS_county.sf$total_pop   / ACS_county.sf$Area
ACS_county.sf$house_density_km2 &lt;- ACS_county.sf$total_house / ACS_county.sf$Area



# OPTIONAL, YOU DON&#39;T HAVE TO DO THIS
# Example plots
# Total population
map_totalpop &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;total_pop&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.blues&quot;, 
                                     style = &quot;jenks&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;County population&quot;)) + 
                tm_basemap(&quot;CartoDB.Voyager&quot;) 

# Area 
map_area &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;Area&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.yl_gn_bu&quot;,
                                     style. = &quot;pretty&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;County area (km2)&quot;)) +
                tm_basemap(&quot;CartoDB.Voyager&quot;)


map_popdens &lt;- tm_shape(ACS_county.sf) + 
                  tm_polygons(fill = &quot;pop_density_km2&quot;,
                     fill.scale  = tm_scale_intervals(
                                     values = &quot;brewer.yl_or_rd&quot;,
                                     style. = &quot;jenks&quot;),
                     fill_alpha  = 0.5,
                     fill.legend = tm_legend(&quot;Population Density (ppl/km2)&quot;)) +
                tm_basemap(&quot;CartoDB.Voyager&quot;)


# Now show them together
tmap_mode(&quot;plot&quot;)
tmap_arrange(map_totalpop,map_area,map_popdens)</code></pre>
<p><img src="Tutorial_CensusData_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
